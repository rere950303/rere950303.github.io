<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>[Spring][JPA][Querydsl] Querydsl - YHW Blog</title>
<meta name="description" content="새로운 배움을 기록하고 공유합니다">


  <meta name="author" content="yhw">
  
  <meta property="article:author" content="yhw">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="YHW Blog">
<meta property="og:title" content="[Spring][JPA][Querydsl] Querydsl">
<meta property="og:url" content="https://rere950303.github.io/spring/jpa/querydsl/Querydsl/">


  <meta property="og:description" content="새로운 배움을 기록하고 공유합니다">







  <meta property="article:published_time" content="2021-10-25T00:00:00+09:00">





  

  


<link rel="canonical" href="https://rere950303.github.io/spring/jpa/querydsl/Querydsl/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "yhw",
      "url": "https://rere950303.github.io/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="YHW Blog Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="manifest" href="/favicon/site.webmanifest">
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          YHW Blog
          <span class="site-subtitle">새로운 배움을 기록하고 공유합니다</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://rere950303.github.io/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#spring" itemprop="item"><span itemprop="name">Spring</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#jpa" itemprop="item"><span itemprop="name">Jpa</span></a>
          <meta itemprop="position" content="3" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#querydsl" itemprop="item"><span itemprop="name">Querydsl</span></a>
          <meta itemprop="position" content="4" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">[Spring][JPA][Querydsl] Querydsl</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/bio/photo.png" alt="yhw" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">yhw</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>어제와 다른 오늘, 오늘 같은 내일</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Republic of Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:yhwjjang1995@naver.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/rere950303" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="[Spring][JPA][Querydsl] Querydsl">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2021-10-25T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">[Spring][JPA][Querydsl] Querydsl
</h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-10-25T00:00:00+09:00">October 25, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 분 소요
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              
                <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
                <ul class="toc__menu">
  <li><a href="#들어가며">들어가며</a></li>
  <li><a href="#기본-문법">기본 문법</a>
    <ul>
      <li><a href="#시작---jpql-vs-querydsl">시작 - JPQL vs Querydsl</a></li>
      <li><a href="#검색-조건-쿼리">검색 조건 쿼리</a></li>
      <li><a href="#결과-조회">결과 조회</a></li>
      <li><a href="#정렬">정렬</a></li>
      <li><a href="#페이징">페이징</a></li>
      <li><a href="#집합">집합</a></li>
      <li><a href="#조인---기본-조인">조인 - 기본 조인</a></li>
      <li><a href="#조인---on절">조인 - on절</a></li>
      <li><a href="#조인---페치-조인">조인 - 페치 조인</a></li>
      <li><a href="#서브-쿼리">서브 쿼리</a></li>
      <li><a href="#case-문">Case 문</a></li>
      <li><a href="#상수-문자-더하기">상수, 문자 더하기</a></li>
    </ul>
  </li>
  <li><a href="#중급-문법">중급 문법</a>
    <ul>
      <li><a href="#프로젝션과-결과-반환---기본">프로젝션과 결과 반환 - 기본</a></li>
      <li><a href="#프로젝션과-결과-반환---dto-조회">프로젝션과 결과 반환 - DTO 조회</a></li>
      <li><a href="#프로젝션과-결과-반환---queryprojection">프로젝션과 결과 반환 - @QueryProjection</a></li>
      <li><a href="#동적-쿼리---booleanbuilder-사용">동적 쿼리 - BooleanBuilder 사용</a></li>
      <li><a href="#동적-쿼리---where-다중-파라미터-사용">동적 쿼리 - Where 다중 파라미터 사용</a></li>
      <li><a href="#수정-삭제-벌크-연산">수정, 삭제 벌크 연산</a></li>
    </ul>
  </li>
  <li><a href="#실무-활용---순수-jpa와-querydsl">실무 활용 - 순수 JPA와 Querydsl</a>
    <ul>
      <li><a href="#동적-쿼리와-성능-최적화-조회---builder-사용">동적 쿼리와 성능 최적화 조회 - Builder 사용</a></li>
      <li><a href="#동적-쿼리와-성능-최적화-조회---where절-파라미터-사용">동적 쿼리와 성능 최적화 조회 - Where절 파라미터 사용</a></li>
    </ul>
  </li>
  <li><a href="#실무-활용---스프링-데이터-jpa와-querydsl">실무 활용 - 스프링 데이터 JPA와 Querydsl</a>
    <ul>
      <li><a href="#사용자-정의-리포지토리">사용자 정의 리포지토리</a></li>
      <li><a href="#스프링-데이터-페이징-활용1---querydsl-페이징-연동">스프링 데이터 페이징 활용1 - Querydsl 페이징 연동</a></li>
      <li><a href="#스프링-데이터-페이징-활용2---countquery-최적화">스프링 데이터 페이징 활용2 - CountQuery 최적화</a></li>
      <li><a href="#스프링-데이터-정렬sort">스프링 데이터 정렬(Sort)</a></li>
    </ul>
  </li>
  <li><a href="#스프링-데이터-jpa가-제공하는-querydsl-기능">스프링 데이터 JPA가 제공하는 Querydsl 기능</a>
    <ul>
      <li><a href="#리포지토리-지원---querydslrepositorysupport">리포지토리 지원 - QuerydslRepositorySupport</a></li>
      <li><a href="#querydsl-지원-클래스-직접-만들기">Querydsl 지원 클래스 직접 만들기</a></li>
    </ul>
  </li>
</ul>

              
            </nav>
            <nav class="toc-custom">
              
            </nav>
          </aside>
        
        <h2 id="들어가며">들어가며</h2>
<p>해당 게시글은 인프런 김영한 강사님의 <a href="https://www.inflearn.com/course/Querydsl-실전/dashboard">실전! Querydsl</a> 강의를 바탕으로 쓰였음을 미리 밝힙니다.</p>

<h2 id="기본-문법">기본 문법</h2>
<h3 id="시작---jpql-vs-querydsl">시작 - JPQL vs Querydsl</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">startJPQL</span><span class="o">()</span> <span class="o">{</span> 
    <span class="c1">//member1을 찾아라.</span>
    <span class="nc">String</span> <span class="n">qlString</span> <span class="o">=</span> 
            <span class="s">"select m from Member m "</span> <span class="o">+</span> 
                    <span class="s">"where m.username = :username"</span><span class="o">;</span>
    <span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">qlString</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
            <span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">"username"</span><span class="o">,</span> <span class="s">"member1"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">getSingleResult</span><span class="o">();</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">findMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"member1"</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">startQuerydsl</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">//member1을 찾아라.</span>
    <span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPAQueryFactory</span><span class="o">(</span><span class="n">em</span><span class="o">);</span>
    <span class="nc">QMember</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QMember</span><span class="o">(</span><span class="s">"m"</span><span class="o">);</span>
    
    <span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">m</span><span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">m</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"member1"</span><span class="o">))</span><span class="c1">//파라미터 바인딩 처리</span>
            <span class="o">.</span><span class="na">fetchOne</span><span class="o">();</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">findMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"member1"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">EntityManager</code> 로 <code class="language-plaintext highlighter-rouge">JPAQueryFactory</code> 생성</li>
  <li>Querydsl은 JPQL 빌더</li>
  <li>JPQL: 문자(실행 시점 오류), Querydsl: 코드(컴파일 시점 오류)</li>
  <li>JPQL: 파라미터 바인딩 직접, Querydsl: 파라미터 바인딩 자동 처리</li>
  <li>JPAQueryFactory를 필드로</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootTest</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuerydslBasicTest</span> <span class="o">{</span>
    <span class="nd">@PersistenceContext</span>
    <span class="nc">EntityManager</span> <span class="n">em</span><span class="o">;</span>

    <span class="nc">JPAQueryFactory</span> <span class="n">queryFactory</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">before</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">queryFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JPAQueryFactory</span><span class="o">(</span><span class="n">em</span><span class="o">);</span>
        <span class="c1">//...</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>JPAQueryFactory를 필드로 제공하면 동시성 문제는 어떻게 될까? 동시성 문제는 JPAQueryFactory를 생성할 때 제공하는 EntityManager(em)에 달려있다. 스프링 프레임워크는 여러 쓰레드에서 동시에 같은 EntityManager에 접근해도, 트랜잭션 마다 별도의 영속성 컨텍스트를 제공하기 때문에, 동시성 문제는 걱정하지 않아도 된다.</li>
</ul>

<h3 id="검색-조건-쿼리">검색 조건 쿼리</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">search</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"member1"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="mi">10</span><span class="o">)))</span>
            <span class="o">.</span><span class="na">fetchOne</span><span class="o">();</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">findMember</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"member1"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>JPQL이 제공하는 모든 검색 조건 제공</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"member1"</span><span class="o">)</span> <span class="c1">// username = 'member1'</span>
<span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">ne</span><span class="o">(</span><span class="s">"member1"</span><span class="o">)</span> <span class="c1">//username != 'member1'</span>
<span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"member1"</span><span class="o">).</span><span class="na">not</span><span class="o">()</span> <span class="c1">// username != 'member1'</span>
<span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">()</span> <span class="c1">//이름이 is not null</span>
<span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">in</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span><span class="mi">20</span><span class="o">)</span> <span class="c1">// age in (10,20)</span>
<span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">notIn</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span><span class="mi">20</span><span class="o">)</span> <span class="c1">// age not in (10, 20)</span>
<span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">between</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span><span class="mi">30</span><span class="o">)</span> <span class="c1">//between 10, 30</span>
<span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">goe</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span> <span class="c1">// age &gt;= 30</span>
<span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span> <span class="c1">// age &gt; 30</span>
<span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">loe</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span> <span class="c1">// age &lt;= 30</span>
<span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">lt</span><span class="o">(</span><span class="mi">30</span><span class="o">)</span> <span class="c1">// age &lt; 30</span>
<span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">like</span><span class="o">(</span><span class="s">"member%"</span><span class="o">)</span> <span class="c1">//like 검색 </span>
<span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"member"</span><span class="o">)</span> <span class="c1">// like ‘%member%’ 검색 </span>
<span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"member"</span><span class="o">)</span> <span class="c1">//like ‘member%’ 검색</span>
</code></pre></div></div>
<ul>
  <li>AND 조건을 파라미터로 처리</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">searchAndParam</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result1</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"member1"</span><span class="o">),</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">result1</span><span class="o">.</span><span class="na">size</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="결과-조회">결과 조회</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">fetch()</code> : 리스트 조회, 데이터 없으면 빈 리스트 반환</li>
  <li><code class="language-plaintext highlighter-rouge">fetchOne()</code> : 단 건 조회
    <ul>
      <li>결과가 없으면 : <code class="language-plaintext highlighter-rouge">null</code></li>
      <li>결과가 둘 이상이면 : <code class="language-plaintext highlighter-rouge">com.querydsl.core.NonUniqueResultException</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">fetchFirst()</code> : <code class="language-plaintext highlighter-rouge">limit(1).fetchOne()</code></li>
  <li><code class="language-plaintext highlighter-rouge">fetchResults()</code> : 페이징 정보 포함, total count 쿼리 추가 실행</li>
  <li><code class="language-plaintext highlighter-rouge">fetchCount()</code> : count 쿼리로 변경해서 count 수 조회</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//List</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">fetch</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
<span class="c1">//단 건</span>
<span class="nc">Member</span> <span class="n">findMember1</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetchOne</span><span class="o">();</span>
<span class="c1">//처음 한 건 조회</span>
<span class="nc">Member</span> <span class="n">findMember2</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetchFirst</span><span class="o">();</span>
<span class="c1">//페이징에서 사용</span>
<span class="nc">QueryResults</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetchResults</span><span class="o">();</span>
<span class="c1">//count 쿼리로 변경</span>
<span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetchCount</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="정렬">정렬</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * 회원 정렬 순서
 * 1. 회원 나이 내림차순(desc)
 * 2. 회원 이름 올림차순(asc)
 * 단 2에서 회원 이름이 없으면 마지막에 출력(nulls last)
 */</span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">sort</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="mi">100</span><span class="o">));</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"member5"</span><span class="o">,</span> <span class="mi">100</span><span class="o">));</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"member6"</span><span class="o">,</span> <span class="mi">100</span><span class="o">));</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="mi">100</span><span class="o">))</span>
            <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">desc</span><span class="o">(),</span> <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">asc</span><span class="o">().</span><span class="na">nullsLast</span><span class="o">())</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    <span class="o">...</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="페이징">페이징</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">paging1</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">desc</span><span class="o">())</span>
            <span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="c1">//0부터 시작(zero index) </span>
            <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="c1">//최대 2건 조회</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">size</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>

    <span class="nc">QueryResults</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">queryResults</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">desc</span><span class="o">())</span>
        <span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetchResults</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>실무에서 페이징 쿼리를 작성할 때, 데이터를 조회하는 쿼리는 여러 테이블을 조인해야 하지만, count 쿼리는 조인이 필요 없는 경우도 있다. 그런데 이렇게 자동화된 count 쿼리는 원본 쿼리와 같이 모두 조인을 해버리기 때문에 성능이 안나올 수 있다. count 쿼리에 조인이 필요없는 성능 최적화가 필요하다면, count 전용 쿼리를 별도로 작성해야 한다.</li>
</ul>

<h3 id="집합">집합</h3>
<ul>
  <li>집합 함수</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">aggregation</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">count</span><span class="o">(),</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">sum</span><span class="o">(),</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">avg</span><span class="o">(),</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">max</span><span class="o">(),</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">min</span><span class="o">())</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="nc">Tuple</span> <span class="n">tuple</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">count</span><span class="o">())).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">sum</span><span class="o">())).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">avg</span><span class="o">())).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">25</span><span class="o">);</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">max</span><span class="o">())).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">40</span><span class="o">);</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">min</span><span class="o">())).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>GroupBy 사용</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">group</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">avg</span><span class="o">())</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">)</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    <span class="nc">Tuple</span> <span class="n">teamA</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="nc">Tuple</span> <span class="n">teamB</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">...</span>
<span class="o">}</span>

<span class="o">...</span>
<span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">)</span>
<span class="o">.</span><span class="na">having</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">price</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mi">1000</span><span class="o">))</span>
<span class="o">...</span>    
</code></pre></div></div>

<h3 id="조인---기본-조인">조인 - 기본 조인</h3>
<ul>
  <li>조인의 기본 문법은 첫 번째 파라미터에 조인 대상을 지정하고, 두 번째 파라미터에 별칭(alias)으로 사용할 Q 타입을 지정하면 된다.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">join</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">QMember</span> <span class="n">member</span> <span class="o">=</span> <span class="nc">QMember</span><span class="o">.</span><span class="na">member</span><span class="o">;</span>
    <span class="nc">QTeam</span> <span class="n">team</span> <span class="o">=</span> <span class="nc">QTeam</span><span class="o">.</span><span class="na">team</span><span class="o">;</span>
    
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"teamA"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">result</span><span class="o">)</span>
            <span class="o">.</span><span class="na">extracting</span><span class="o">(</span><span class="s">"username"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">containsExactly</span><span class="o">(</span><span class="s">"member1"</span><span class="o">,</span> <span class="s">"member2"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">join()</code> , <code class="language-plaintext highlighter-rouge">innerJoin()</code> : 내부 조인(inner join)</li>
  <li><code class="language-plaintext highlighter-rouge">leftJoin()</code> : left 외부 조인(left outer join)</li>
  <li><code class="language-plaintext highlighter-rouge">rightJoin()</code> : rigth 외부 조인(rigth outer join)</li>
  <li>JPQL의 <code class="language-plaintext highlighter-rouge">on</code>과 성능 최적화를 위한 <code class="language-plaintext highlighter-rouge">fetch</code> 조인 제공</li>
  <li>세타 조인(연관관계가 없는 필드로 조인)</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">theta_join</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"teamA"</span><span class="o">));</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"teamB"</span><span class="o">));</span>
    
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">result</span><span class="o">)</span>
            <span class="o">.</span><span class="na">extracting</span><span class="o">(</span><span class="s">"username"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">containsExactly</span><span class="o">(</span><span class="s">"teamA"</span><span class="o">,</span> <span class="s">"teamB"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>from 절에 여러 엔티티를 선택해서 세타 조인</li>
</ul>

<h3 id="조인---on절">조인 - on절</h3>
<ul>
  <li>조인 대상 필터링</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">join_on_filtering</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">).</span><span class="na">on</span><span class="o">(</span><span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"teamA"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="k">for</span> <span class="o">(</span><span class="nc">Tuple</span> <span class="n">tuple</span> <span class="o">:</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"tuple = "</span> <span class="o">+</span> <span class="n">tuple</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>
    <p>on 절을 활용해 조인 대상을 필터링 할 때, 외부조인이 아니라 내부조인(inner join)을 사용하면, where 절에서 필터링 하는 것과 기능이 동일하다. 따라서 on 절을 활용한 조인 대상 필터링을 사용할 때, 내부조인 이면 익숙한 where 절로 해결하고, 정말 외부조인이 필요한 경우에만 이 기능을 사용하자.</p>
  </li>
  <li>
    <p>연관관계 없는 엔티티 외부 조인</p>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">join_on_no_relation</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"teamA"</span><span class="o">));</span>
    <span class="n">em</span><span class="o">.</span><span class="na">persist</span><span class="o">(</span><span class="k">new</span> <span class="nc">Member</span><span class="o">(</span><span class="s">"teamB"</span><span class="o">));</span>
    
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">team</span><span class="o">).</span><span class="na">on</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="k">for</span> <span class="o">(</span><span class="nc">Tuple</span> <span class="n">tuple</span> <span class="o">:</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"t="</span> <span class="o">+</span> <span class="n">tuple</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>일반조인: <code class="language-plaintext highlighter-rouge">leftJoin(member.team, team)</code></li>
  <li>on조인: <code class="language-plaintext highlighter-rouge">from(member).leftJoin(team).on(xxx)</code></li>
</ul>

<h3 id="조인---페치-조인">조인 - 페치 조인</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">fetchJoinUse</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">em</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
    <span class="n">em</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>

    <span class="nc">Member</span> <span class="n">findMember</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">).</span><span class="na">fetchJoin</span><span class="o">()</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"member1"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetchOne</span><span class="o">();</span>
    
    <span class="kt">boolean</span> <span class="n">loaded</span> <span class="o">=</span> <span class="n">emf</span><span class="o">.</span><span class="na">getPersistenceUnitUtil</span><span class="o">().</span><span class="na">isLoaded</span><span class="o">(</span><span class="n">findMember</span><span class="o">.</span><span class="na">getTeam</span><span class="o">());</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">loaded</span><span class="o">).</span><span class="na">as</span><span class="o">(</span><span class="s">"페치 조인 적용"</span><span class="o">).</span><span class="na">isTrue</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">join()</code>, <code class="language-plaintext highlighter-rouge">leftJoin()</code> 등 조인 기능 뒤에 <code class="language-plaintext highlighter-rouge">fetchJoin()</code> 이라고 추가하면 된다.</li>
</ul>

<h3 id="서브-쿼리">서브 쿼리</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">com.querydsl.jpa.JPAExpressions</code> 사용</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">subQuery</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">QMember</span> <span class="n">memberSub</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QMember</span><span class="o">(</span><span class="s">"memberSub"</span><span class="o">);</span>
    
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span>
                    <span class="nc">JPAExpressions</span>
                            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">memberSub</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">max</span><span class="o">())</span>
                            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">memberSub</span><span class="o">)</span>
            <span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="na">extracting</span><span class="o">(</span><span class="s">"age"</span><span class="o">).</span><span class="na">containsExactly</span><span class="o">(</span><span class="mi">40</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">subQueryGoe</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">QMember</span> <span class="n">memberSub</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QMember</span><span class="o">(</span><span class="s">"memberSub"</span><span class="o">);</span>
    
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">goe</span><span class="o">(</span>
                    <span class="nc">JPAExpressions</span>
                            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">memberSub</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">avg</span><span class="o">())</span>
                            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">memberSub</span><span class="o">)</span>
            <span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="na">extracting</span><span class="o">(</span><span class="s">"age"</span><span class="o">).</span><span class="na">containsExactly</span><span class="o">(</span><span class="mi">30</span><span class="o">,</span> <span class="mi">40</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">subQueryIn</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">QMember</span> <span class="n">memberSub</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QMember</span><span class="o">(</span><span class="s">"memberSub"</span><span class="o">);</span>
    
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">in</span><span class="o">(</span>
                    <span class="nc">JPAExpressions</span>
                            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">memberSub</span><span class="o">.</span><span class="na">age</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">memberSub</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">memberSub</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
            <span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="n">assertThat</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="na">extracting</span><span class="o">(</span><span class="s">"age"</span><span class="o">).</span><span class="na">containsExactly</span><span class="o">(</span><span class="mi">20</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="mi">40</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple</span><span class="o">&gt;</span> <span class="n">fetch</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span>
                <span class="nc">JPAExpressions</span>
                        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">memberSub</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">avg</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">memberSub</span><span class="o">)</span>
        <span class="o">).</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>

<span class="k">for</span><span class="o">(</span><span class="nc">Tuple</span> <span class="n">tuple</span> <span class="o">:</span> <span class="n">fetch</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"username = "</span> <span class="o">+</span> <span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">));</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"age = "</span> <span class="o">+</span>
              <span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="nc">JPAExpressions</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">memberSub</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">avg</span><span class="o">())</span>
                      <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">memberSub</span><span class="o">)));</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>static import 활용 가능</li>
  <li>from 절의 서브쿼리 한계: JPA JPQL 서브쿼리의 한계점으로 from 절의 서브쿼리(인라인 뷰)는 지원하지 않는다. 당연히 Querydsl 도 지원하지 않는다. 하이버네이트 구현체를 사용하면 select 절의 서브쿼리는 지원한다. Querydsl도 하이버네이트 구현체를 사용하면 select 절의 서브쿼리를 지원한다.</li>
</ul>

<h3 id="case-문">Case 문</h3>
<ul>
  <li>select, 조건절(where), order by에서 사용 가능</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span>
                <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">then</span><span class="o">(</span><span class="s">"열살"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="mi">20</span><span class="o">).</span><span class="na">then</span><span class="o">(</span><span class="s">"스무살"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">otherwise</span><span class="o">(</span><span class="s">"기타"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">CaseBuilder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">between</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">20</span><span class="o">)).</span><span class="na">then</span><span class="o">(</span><span class="s">"0~20살"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">between</span><span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="mi">30</span><span class="o">)).</span><span class="na">then</span><span class="o">(</span><span class="s">"21~30살"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">otherwise</span><span class="o">(</span><span class="s">"기타"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">NumberExpression</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">rankPath</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CaseBuilder</span><span class="o">()</span>
        <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">between</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">20</span><span class="o">)).</span><span class="na">then</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
        <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">between</span><span class="o">(</span><span class="mi">21</span><span class="o">,</span> <span class="mi">30</span><span class="o">)).</span><span class="na">then</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">otherwise</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span> <span class="n">rankPath</span><span class="o">)</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">rankPath</span><span class="o">.</span><span class="na">desc</span><span class="o">())</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="상수-문자-더하기">상수, 문자 더하기</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Tuple</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span> <span class="nc">Expressions</span><span class="o">.</span><span class="na">constant</span><span class="o">(</span><span class="s">"A"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetchFirst</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="s">"_"</span><span class="o">).</span><span class="na">concat</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">stringValue</span><span class="o">()))</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">"member1"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">fetchOne</span><span class="o">();</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">member.age.stringValue()</code> 부분이 중요한데, 문자가 아닌 다른 타입들은 <code class="language-plaintext highlighter-rouge">stringValue()</code> 로 문자로 변환할 수 있다. 이 방법은 ENUM을 처리할 때도 자주 사용한다.</li>
</ul>

<h2 id="중급-문법">중급 문법</h2>
<h3 id="프로젝션과-결과-반환---기본">프로젝션과 결과 반환 - 기본</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">)</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Tuple</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">)</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
     
<span class="k">for</span> <span class="o">(</span><span class="nc">Tuple</span> <span class="n">tuple</span> <span class="o">:</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
     <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">);</span>
     <span class="nc">Integer</span> <span class="n">age</span> <span class="o">=</span> <span class="n">tuple</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">);</span>
     <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"username="</span> <span class="o">+</span> <span class="n">username</span><span class="o">);</span>
     <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"age="</span> <span class="o">+</span> <span class="n">age</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<h3 id="프로젝션과-결과-반환---dto-조회">프로젝션과 결과 반환 - DTO 조회</h3>
<ul>
  <li>프로퍼티 접근 - Setter
    <ul>
      <li>기본 생성자 필요, 세터 필요</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberDto</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="nc">Projections</span><span class="o">.</span><span class="na">bean</span><span class="o">(</span><span class="nc">MemberDto</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span>
                <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">))</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>
<ul>
  <li>필드 직접 접근
    <ul>
      <li>게터, 세터 필요 없음</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberDto</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="nc">Projections</span><span class="o">.</span><span class="na">fields</span><span class="o">(</span><span class="nc">MemberDto</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span>
                <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">))</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>

<ul>
  <li>별칭이 다를 때
    <ul>
      <li>프로퍼티나, 필드 접근 생성 방식에서 이름이 다를 때 해결 방안</li>
      <li><code class="language-plaintext highlighter-rouge">ExpressionUtils.as(source,alias)</code> : 필드나, 서브 쿼리에 별칭 적용</li>
      <li><code class="language-plaintext highlighter-rouge">username.as("memberName")</code> : 필드에 별칭 적용</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDto</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>
<span class="o">}</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">UserDto</span><span class="o">&gt;</span> <span class="n">fetch</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="nc">Projections</span><span class="o">.</span><span class="na">fields</span><span class="o">(</span><span class="nc">UserDto</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                        <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">as</span><span class="o">(</span><span class="s">"name"</span><span class="o">),</span>
                        <span class="nc">ExpressionUtils</span><span class="o">.</span><span class="na">as</span><span class="o">(</span>
                                <span class="nc">JPAExpressions</span>
                                        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">memberSub</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">max</span><span class="o">())</span>
                                        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">memberSub</span><span class="o">),</span> <span class="s">"age"</span><span class="o">)</span>
                        <span class="o">)</span>
                <span class="o">).</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
                <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>
<ul>
  <li>생성자 사용(값 타입을 기준으로 매핑)</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberDto</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="nc">Projections</span><span class="o">.</span><span class="na">constructor</span><span class="o">(</span><span class="nc">MemberDto</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span>
                <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">))</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="프로젝션과-결과-반환---queryprojection">프로젝션과 결과 반환 - @QueryProjection</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MemberDto</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">age</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">MemberDto</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="nd">@QueryProjection</span>
    <span class="kd">public</span> <span class="nf">MemberDto</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">username</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberDto</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">QMemberDto</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">))</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>
<ul>
  <li>이 방법은 컴파일러로 타입을 체크할 수 있으므로 가장 안전한 방법이다. 다만 DTO에 QueryDSL 어노테이션을 유지해야 하는점과 DTO까지 Q 파일을 생성해야 하는 단점이 있다.</li>
</ul>

<h3 id="동적-쿼리---booleanbuilder-사용">동적 쿼리 - BooleanBuilder 사용</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="n">동적쿼리_BooleanBuilder</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">usernameParam</span> <span class="o">=</span> <span class="s">"member1"</span><span class="o">;</span>
    <span class="nc">Integer</span> <span class="n">ageParam</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">searchMember1</span><span class="o">(</span><span class="n">usernameParam</span><span class="o">,</span> <span class="n">ageParam</span><span class="o">);</span>
    <span class="nc">Assertions</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">size</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">searchMember1</span><span class="o">(</span><span class="nc">String</span> <span class="n">usernameCond</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">ageCond</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">BooleanBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BooleanBuilder</span><span class="o">();</span>
    
    <span class="k">if</span> <span class="o">(</span><span class="n">usernameCond</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">usernameCond</span><span class="o">));</span>
    <span class="o">}</span>
    
    <span class="k">if</span> <span class="o">(</span><span class="n">ageCond</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">ageCond</span><span class="o">));</span>
    <span class="o">}</span>
    
    <span class="k">return</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">builder</span><span class="o">)</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="동적-쿼리---where-다중-파라미터-사용">동적 쿼리 - Where 다중 파라미터 사용</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="n">동적쿼리_WhereParam</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">usernameParam</span> <span class="o">=</span> <span class="s">"member1"</span><span class="o">;</span>
    <span class="nc">Integer</span> <span class="n">ageParam</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">searchMember2</span><span class="o">(</span><span class="n">usernameParam</span><span class="o">,</span> <span class="n">ageParam</span><span class="o">);</span>
    <span class="nc">Assertions</span><span class="o">.</span><span class="na">assertThat</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">size</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">searchMember2</span><span class="o">(</span><span class="nc">String</span> <span class="n">usernameCond</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">ageCond</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">usernameCond</span><span class="o">),</span> <span class="n">ageEq</span><span class="o">(</span><span class="n">ageCond</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">usernameEq</span><span class="o">(</span><span class="nc">String</span> <span class="n">usernameCond</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">usernameCond</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">usernameCond</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">ageEq</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">ageCond</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">ageCond</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">ageCond</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">where</code> 조건에 <code class="language-plaintext highlighter-rouge">null</code> 값은 무시된다.</li>
  <li>메서드를 다른 쿼리에서도 재활용 할 수 있다.</li>
  <li>쿼리 자체의 가독성이 높아진다.</li>
  <li>조합 가능</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">allEq</span><span class="o">(</span><span class="nc">String</span> <span class="n">usernameCond</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">ageCond</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">usernameEq</span><span class="o">(</span><span class="n">usernameCond</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">ageEq</span><span class="o">(</span><span class="n">ageCond</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="수정-삭제-벌크-연산">수정, 삭제 벌크 연산</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span> <span class="s">"비회원"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">lt</span><span class="o">(</span><span class="mi">28</span><span class="o">))</span>
        <span class="o">.</span><span class="na">execute</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">1</span><span class="o">))</span>
        <span class="o">.</span><span class="na">execute</span><span class="o">();</span>
</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">gt</span><span class="o">(</span><span class="mi">18</span><span class="o">))</span>
        <span class="o">.</span><span class="na">execute</span><span class="o">();</span>
</code></pre></div></div>
<ul>
  <li>주의: update JPQL 실행 후 DB 조회시 최신 데이터와 조회된 데이터가 다를수 있다. 왜냐하면 update 쿼리 후 DB 조회시 조회된 데이터를 영속성 컨텍스트의 데이터와 비교한 후에 만일 그 값이 다르다면 영속성 컨텍스트가 우선권을 가지기 때문이다. 따라서 벌크성 쿼리후에는 영속성 컨텍스트를 초기화 하는 것이 안전하다.</li>
</ul>

<h2 id="실무-활용---순수-jpa와-querydsl">실무 활용 - 순수 JPA와 Querydsl</h2>
<h3 id="동적-쿼리와-성능-최적화-조회---builder-사용">동적 쿼리와 성능 최적화 조회 - Builder 사용</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Builder 사용</span>
<span class="c1">//회원명, 팀명, 나이(ageGoe, ageLoe)</span>
<span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">searchByBuilder</span><span class="o">(</span><span class="nc">MemberSearchCondition</span> <span class="n">condition</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">BooleanBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BooleanBuilder</span><span class="o">();</span>
    
    <span class="k">if</span> <span class="o">(</span><span class="n">hasText</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()))</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()));</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">hasText</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()))</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()));</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">goe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()));</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">loe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()));</span>
    <span class="o">}</span>
    
    <span class="k">return</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">QMemberTeamDto</span><span class="o">(</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span>
                    <span class="n">team</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">builder</span><span class="o">)</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="동적-쿼리와-성능-최적화-조회---where절-파라미터-사용">동적 쿼리와 성능 최적화 조회 - Where절 파라미터 사용</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="nc">MemberSearchCondition</span> <span class="n">condition</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">QMemberTeamDto</span><span class="o">(</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span>
                    <span class="n">team</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span>
                    <span class="n">teamNameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
                    <span class="n">ageGoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
                    <span class="n">ageLoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">usernameEq</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">isEmpty</span><span class="o">(</span><span class="n">username</span><span class="o">)</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">teamNameEq</span><span class="o">(</span><span class="nc">String</span> <span class="n">teamName</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nf">isEmpty</span><span class="o">(</span><span class="n">teamName</span><span class="o">)</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">teamName</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">ageGoe</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">ageGoe</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">ageGoe</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">goe</span><span class="o">(</span><span class="n">ageGoe</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="nc">BooleanExpression</span> <span class="nf">ageLoe</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">ageLoe</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">ageLoe</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">.</span><span class="na">loe</span><span class="o">(</span><span class="n">ageLoe</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>where 절에 파라미터 방식을 사용하면 조건 재사용 가능</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="nf">findMember</span><span class="o">(</span><span class="nc">MemberSearchCondition</span> <span class="n">condition</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span>
                    <span class="n">teamNameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
                    <span class="n">ageGoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
                    <span class="n">ageLoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="실무-활용---스프링-데이터-jpa와-querydsl">실무 활용 - 스프링 데이터 JPA와 Querydsl</h2>
<h3 id="사용자-정의-리포지토리">사용자 정의 리포지토리</h3>
<ul>
  <li>사용자 정의 인터페이스 작성</li>
  <li>사용자 정의 인터페이스 구현</li>
  <li>스프링 데이터 리포지토리에 사용자 정의 인터페이스 상속</li>
</ul>

<figure class=" ">
  
    
      <a href="/assets/images/post/Spring/JPA/Querydsl/1.png">
          <img src="/assets/images/post/Spring/JPA/Querydsl/1.png" alt="" />
      </a>
    
  
  
</figure>

<h3 id="스프링-데이터-페이징-활용1---querydsl-페이징-연동">스프링 데이터 페이징 활용1 - Querydsl 페이징 연동</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * 단순한 페이징, fetchResults() 사용
 */</span>
<span class="nd">@Override</span>
<span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">searchPageSimple</span><span class="o">(</span><span class="nc">MemberSearchCondition</span> <span class="n">condition</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">QueryResults</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">QMemberTeamDto</span><span class="o">(</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span>
                    <span class="n">team</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span>
                    <span class="n">teamNameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
                    <span class="n">ageGoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
                    <span class="n">ageLoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="n">pageable</span><span class="o">.</span><span class="na">getOffset</span><span class="o">())</span>
            <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">pageable</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">())</span>
            <span class="o">.</span><span class="na">fetchResults</span><span class="o">();</span>
    
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="n">content</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="na">getResults</span><span class="o">();</span>
    <span class="kt">long</span> <span class="n">total</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="na">getTotal</span><span class="o">();</span>
    
    <span class="k">return</span> <span class="k">new</span> <span class="nc">PageImpl</span><span class="o">&lt;&gt;(</span><span class="n">content</span><span class="o">,</span> <span class="n">pageable</span><span class="o">,</span> <span class="n">total</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>Querydsl이 제공하는 <code class="language-plaintext highlighter-rouge">fetchResults()</code> 를 사용하면 내용과 전체 카운트를 한번에 조회할 수 있다.(실제 쿼리는 2번 호출)</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">fetchResult()</code> 는 카운트 쿼리 실행시 필요없는 <code class="language-plaintext highlighter-rouge">order by</code> 는 제거한다.</p>
  </li>
  <li>데이터 내용과 전체 카운트를 별도로 조회하는 방법</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="nf">searchPageComplex</span><span class="o">(</span><span class="nc">MemberSearchCondition</span> <span class="n">condition</span><span class="o">,</span> <span class="nc">Pageable</span> <span class="n">pageable</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">MemberTeamDto</span><span class="o">&gt;</span> <span class="n">content</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="k">new</span> <span class="nc">QMemberTeamDto</span><span class="o">(</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">username</span><span class="o">,</span>
                    <span class="n">member</span><span class="o">.</span><span class="na">age</span><span class="o">,</span>
                    <span class="n">team</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="n">team</span><span class="o">.</span><span class="na">name</span><span class="o">))</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span>
                    <span class="n">teamNameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
                    <span class="n">ageGoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
                    <span class="n">ageLoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">offset</span><span class="o">(</span><span class="n">pageable</span><span class="o">.</span><span class="na">getOffset</span><span class="o">())</span>
            <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="n">pageable</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">())</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
    
    <span class="kt">long</span> <span class="n">total</span> <span class="o">=</span> <span class="n">queryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span>
                    <span class="n">teamNameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
                    <span class="n">ageGoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
                    <span class="n">ageLoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">fetchCount</span><span class="o">();</span>
    
    <span class="k">return</span> <span class="k">new</span> <span class="nc">PageImpl</span><span class="o">&lt;&gt;(</span><span class="n">content</span><span class="o">,</span> <span class="n">pageable</span><span class="o">,</span> <span class="n">total</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
  <li>전체 카운트를 조회 하는 방법을 최적화 할 수 있으면 이렇게 분리하면 된다. (예를 들어서 전체 카운트를 조회할 때 조인 쿼리를 줄일 수 있다면 상당한 효과가 있다.)</li>
</ul>

<h3 id="스프링-데이터-페이징-활용2---countquery-최적화">스프링 데이터 페이징 활용2 - CountQuery 최적화</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JPAQuery</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">countQuery</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">member</span><span class="o">)</span>
        <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">team</span><span class="o">,</span> <span class="n">team</span><span class="o">)</span>
        <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">usernameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()),</span>
                <span class="n">teamNameEq</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getTeamName</span><span class="o">()),</span>
                <span class="n">ageGoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeGoe</span><span class="o">()),</span>
                <span class="n">ageLoe</span><span class="o">(</span><span class="n">condition</span><span class="o">.</span><span class="na">getAgeLoe</span><span class="o">()));</span>

      <span class="c1">// return new PageImpl&lt;&gt;(content, pageable, total);</span>
      <span class="k">return</span> <span class="nc">PageableExecutionUtils</span><span class="o">.</span><span class="na">getPage</span><span class="o">(</span><span class="n">content</span><span class="o">,</span><span class="n">pageable</span><span class="o">,</span> <span class="nl">countQuery:</span><span class="o">:</span><span class="n">fetchCount</span><span class="o">);</span>
</code></pre></div></div>
<ul>
  <li>count 쿼리가 생략 가능한 경우 생략해서 처리
    <ul>
      <li>페이지 시작이면서 컨텐츠 사이즈가 페이지 사이즈보다 작을 때</li>
      <li>마지막 페이지 일 때 (offset + 컨텐츠 사이즈를 더해서 전체 사이즈 구함)</li>
    </ul>
  </li>
</ul>

<h3 id="스프링-데이터-정렬sort">스프링 데이터 정렬(Sort)</h3>
<ul>
  <li>스프링 데이터 JPA는 자신의 정렬(Sort)을 Querydsl의 정렬(OrderSpecifier)로 편리하게 변경하는 기능을 제공한다.</li>
  <li>스프링 데이터의 정렬을 Querydsl의 정렬로 직접 전환하는 방법은 다음 코드를 참고하자.</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JPAQuery</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">query</span> <span class="o">=</span> <span class="n">queryFactory</span>
        <span class="o">.</span><span class="na">selectFrom</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="nc">Sort</span><span class="o">.</span><span class="na">Order</span> <span class="n">o</span> <span class="o">:</span> <span class="n">pageable</span><span class="o">.</span><span class="na">getSort</span><span class="o">())</span> <span class="o">{</span>
      <span class="nc">PathBuilder</span> <span class="n">pathBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PathBuilder</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getType</span><span class="o">(),</span> <span class="n">member</span><span class="o">.</span><span class="na">getMetadata</span><span class="o">());</span>
      <span class="n">query</span><span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="k">new</span> <span class="nc">OrderSpecifier</span><span class="o">(</span><span class="n">o</span><span class="o">.</span><span class="na">isAscending</span><span class="o">()</span> <span class="o">?</span> <span class="nc">Order</span><span class="o">.</span><span class="na">ASC</span> <span class="o">:</span> <span class="nc">Order</span><span class="o">.</span><span class="na">DESC</span><span class="o">,</span> <span class="n">pathBuilder</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">o</span><span class="o">.</span><span class="na">getProperty</span><span class="o">())));</span>
<span class="o">}</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
</code></pre></div></div>
<ul>
  <li>정렬( <code class="language-plaintext highlighter-rouge">Sort</code> )은 조건이 조금만 복잡해져도 <code class="language-plaintext highlighter-rouge">Pageable</code> 의 <code class="language-plaintext highlighter-rouge">Sort</code> 기능을 사용하기 어렵다. 루트 엔티티 범위를 넘어가는 동적 정렬 기능이 필요하면 스프링 데이터 페이징이 제공하는 Sort 를 사용하기 보다는 파라미터를 받아서 직접 처리하는 것을 권장한다.</li>
  <li><code class="language-plaintext highlighter-rouge">Sort</code>는 스프링 데이터 JPA에서 만든 정렬 클래스이며 이를 Querydsl에서 사용하기 위해서는 위와 같은 로직을 직접 코딩하거나 스프링 데이터 JPA가 제공하는 리포지토리 내지 사용자 정의 Querydsl 지원 클래스를 사용해야 한다.</li>
</ul>

<h2 id="스프링-데이터-jpa가-제공하는-querydsl-기능">스프링 데이터 JPA가 제공하는 Querydsl 기능</h2>
<h3 id="리포지토리-지원---querydslrepositorysupport">리포지토리 지원 - QuerydslRepositorySupport</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">getQuerydsl().applyPagination()</code> 스프링 데이터가 제공하는 페이징을 Querydsl로 편리하게 변환 가능(단! Sort는 오류발생)</li>
  <li><code class="language-plaintext highlighter-rouge">EntityManager</code> 제공</li>
  <li>한계
    <ul>
      <li>Querydsl 3.x 버전을 대상으로 만듬</li>
      <li>Querydsl 4.x에 나온 <code class="language-plaintext highlighter-rouge">JPAQueryFactory</code>로 시작할 수 없음</li>
      <li>select로 시작할 수 없음 (from으로 시작해야함)</li>
      <li><code class="language-plaintext highlighter-rouge">JPAQueryFactory</code> 를 제공하지 않음</li>
      <li>스프링 데이터 Sort 기능이 정상 동작하지 않음</li>
    </ul>
  </li>
</ul>

<h3 id="querydsl-지원-클래스-직접-만들기">Querydsl 지원 클래스 직접 만들기</h3>
<ul>
  <li>스프링 데이터가 제공하는 페이징을 편리하게 변환</li>
  <li>페이징과 카운트 쿼리 분리 가능</li>
  <li>스프링 데이터 Sort 지원</li>
  <li><code class="language-plaintext highlighter-rouge">select()</code> , <code class="language-plaintext highlighter-rouge">selectFrom()</code> 으로 시작 가능</li>
  <li><code class="language-plaintext highlighter-rouge">EntityManager</code> , <code class="language-plaintext highlighter-rouge">JPAQueryFactory</code> 제공</li>
</ul>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#jpa" class="page__taxonomy-item" rel="tag">JPA</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#querydsl" class="page__taxonomy-item" rel="tag">Querydsl</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#spring" class="page__taxonomy-item" rel="tag">Spring</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#spring-jpa-querydsl" class="page__taxonomy-item" rel="tag">Spring/JPA/Querydsl</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2021-10-25T00:00:00+09:00">October 25, 2021</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%5BSpring%5D%5BJPA%5D%5BQuerydsl%5D+Querydsl%20https%3A%2F%2Frere950303.github.io%2Fspring%2Fjpa%2Fquerydsl%2FQuerydsl%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Frere950303.github.io%2Fspring%2Fjpa%2Fquerydsl%2FQuerydsl%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Frere950303.github.io%2Fspring%2Fjpa%2Fquerydsl%2FQuerydsl%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/spring/jpa/save&merge/" class="pagination--pager" title="[Spring][JPA] 변경 감지와 병합
">이전</a>
    
    
      <a href="#" class="pagination--pager disabled">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">연관글</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/jpa/save&merge/" rel="permalink">[Spring][JPA] 변경 감지와 병합
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-10-24T00:00:00+09:00">October 24, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/jpa/SpringDataJPA/" rel="permalink">[Spring][JPA] 스프링 데이터 JPA
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-10-24T00:00:00+09:00">October 24, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          7 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/jpa/OSIV/" rel="permalink">[Spring][JPA] OSIV
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-10-20T00:00:00+09:00">October 20, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          최대 1 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spring/jpa/JPA/" rel="permalink">[Spring][JPA] 자바 ORM 표준 JPA
</a>
      
    </h2>
    

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-fw fa-calendar-alt" aria-hidden="true"></i>
        <time datetime="2021-10-02T00:00:00+09:00">October 2, 2021</time>
      </span>
    

    <span class="page__meta-sep"></span>

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-fw fa-clock" aria-hidden="true"></i>
        
          22 분 소요
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력하세요..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      
        
      
        
      
        
          <li><a href="https://github.com/rere950303" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    
    
    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 yhw. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'rere950303/rere950303.github.io');
    script.setAttribute('issue-term', 'title');
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  





  </body>
</html>
